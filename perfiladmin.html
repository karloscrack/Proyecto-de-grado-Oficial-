<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="Panel de Administraci√≥n Avanzado - U.E. Despertar">
    <meta name="theme-color" content="#6A0DAD">
    
    <title>Admin Panel - Unidad Educativa Despertar</title>
    
    <link rel="icon" type="image/png" href="Img/Logo_pesta√±a.png">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* ==========================================================================
           1. CORE DESIGN SYSTEM (Tokens id√©nticos al perfil estudiante)
           ========================================================================== */
        :root {
            /* Branding */
            --primary: #6A0DAD;       
            --primary-dark: #4a0072;  
            --primary-light: #9d46ff; 
            --primary-soft: rgba(106, 13, 173, 0.08);
            
            --secondary: #2E8B57;     
            --secondary-hover: #1e5e3a;
            
            --error: #d32f2f;         
            --warning: #f9a825;       
            --info: #0288d1;          
            
            /* Theme Colors (Light) */
            --bg-image: url('Img/Claro.png'); 
            --bg-body: #f4f6f9;
            --bg-card: #ffffff;
            --bg-header: rgba(255, 255, 255, 0.98);
            --bg-sidebar: #ffffff;
            
            --text-main: #2c3e50;
            --text-sec: #5f6368;
            --text-muted: #9aa0a6;
            --text-inverse: #ffffff;
            
            --border-color: #e0e0e0;
            --input-bg: #f8f9fa;
            
            /* Effects */
            --shadow-soft: 0 4px 20px rgba(0,0,0,0.05);
            --shadow-card: 0 2px 8px rgba(0,0,0,0.04);
            --shadow-hover: 0 10px 25px rgba(106, 13, 173, 0.15);
            --shadow-nav: 0 2px 15px rgba(0,0,0,0.05);
            
            --glass-backdrop: blur(12px);
            
            /* Layout */
            --header-height: 80px;
            --sidebar-width: 280px;
            --border-radius: 16px;
            --transition-speed: 0.3s;
        }

        /* Dark Mode High Contrast Fix */
        body.dark-mode {
            --bg-image: url('Img/Oscuro.png');
            --bg-body: #121212;
            --bg-card: #1e1e1e;
            --bg-header: rgba(30, 30, 30, 0.98);
            --bg-sidebar: #1a1a1a;
            
            /* Textos m√°s brillantes para contraste */
            --text-main: #f0f2f5; 
            --text-sec: #d0d3d8; 
            --text-muted: #a0a3a8;
            
            --border-color: #333333;
            --input-bg: #2d2d2d;
            
            --shadow-soft: 0 4px 20px rgba(0,0,0,0.4);
            --shadow-hover: 0 10px 30px rgba(0,0,0,0.6);
        }

        /* Reset & Base */
        * { margin: 0; padding: 0; box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-body);
            background-image: var(--bg-image);
            background-attachment: fixed;
            background-size: cover;
            background-position: center;
            color: var(--text-main);
            padding-top: var(--header-height);
            min-height: 100vh;
            display: flex; flex-direction: column;
            overflow-x: hidden; /* Evitar scroll horizontal en m√≥vil */
        }

        a { text-decoration: none; color: inherit; transition: var(--transition-speed); }
        ul { list-style: none; }
        
        /* Scrollbar Personalizado */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--primary-dark); }

        /* ==========================================================================
           2. HEADER (Copia exacta de Estudiante)
           ========================================================================== */
        .main-header {
            position: fixed; top: 0; left: 0; width: 100%;
            height: var(--header-height);
            background: var(--bg-header);
            border-bottom: 3px solid var(--primary);
            box-shadow: var(--shadow-nav);
            z-index: 1000;
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 20px;
            backdrop-filter: blur(10px);
        }

        .logo-container img {
            height: 50px; width: auto;
            transition: transform 0.3s;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }
        .logo-container img:hover { transform: scale(1.05); }

        .header-actions { display: flex; align-items: center; gap: 15px; }

        .btn-icon-header {
            background: transparent; border: 2px solid var(--primary);
            color: var(--primary); width: 42px; height: 42px;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 1.2rem; cursor: pointer; transition: 0.3s;
            position: relative;
        }
        .btn-icon-header:hover { background: var(--primary-soft); transform: rotate(15deg); }

        /* Notificaci√≥n Badge */
        .noti-badge {
            position: absolute; top: -5px; right: -5px;
            background: var(--error); color: white;
            font-size: 0.7rem; font-weight: 700;
            width: 20px; height: 20px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            border: 2px solid var(--bg-header);
        }

        .btn-logout-header {
            background: var(--error); color: white; border: none;
            padding: 0 25px; height: 42px; border-radius: 50px;
            font-weight: 600; font-size: 0.95rem; cursor: pointer;
            display: flex; align-items: center; gap: 8px; transition: 0.3s;
            box-shadow: 0 4px 10px rgba(211, 47, 47, 0.25);
        }
        .btn-logout-header:hover { background: #b71c1c; transform: translateY(-2px); }

        .menu-toggle {
            display: none; /* Se activa en m√≥vil */
            background: none; border: none; font-size: 1.8rem;
            color: var(--primary); cursor: pointer;
            width: 45px; height: 45px; align-items: center; justify-content: center;
        }

        /* Dropdown Notificaciones (No intrusivo) */
        .notis-dropdown {
            position: absolute; top: 70px; right: 20px;
            width: 320px; max-height: 400px;
            background: var(--bg-card); border: 1px solid var(--border-color);
            border-radius: 12px; box-shadow: 0 15px 40px rgba(0,0,0,0.2);
            z-index: 1100; display: none; flex-direction: column; overflow: hidden;
        }
        .notis-dropdown.active { display: flex; animation: fadeIn 0.2s; }
        .notis-header {
            padding: 12px; background: var(--input-bg); border-bottom: 1px solid var(--border-color);
            font-weight: bold; font-size: 0.9rem; color: var(--text-main);
        }
        .notis-body { overflow-y: auto; max-height: 350px; }
        .noti-item {
            padding: 12px; border-bottom: 1px solid var(--border-color);
            cursor: pointer; transition: 0.2s;
        }
        .noti-item:hover { background: var(--input-bg); }
        .noti-item h4 { margin: 0; font-size: 0.85rem; color: var(--text-main); }
        .noti-item p { margin: 2px 0 0; font-size: 0.8rem; color: var(--text-sec); }
        .noti-preview {
            width: 100%; height: 60px; object-fit: cover; border-radius: 4px; margin-top: 5px; border: 1px solid var(--border-color);
        }

        /* ==========================================================================
           3. SIDEBAR FIJO (Navegaci√≥n Admin)
           ========================================================================== */
        .admin-layout { display: flex; width: 100%; max-width: 1600px; margin: 0 auto; min-height: calc(100vh - var(--header-height)); }

        .sidebar {
            width: var(--sidebar-width);
            background: var(--bg-sidebar);
            border-right: 1px solid var(--border-color);
            position: sticky; top: var(--header-height);
            height: calc(100vh - var(--header-height));
            overflow-y: auto; padding: 20px;
            display: flex; flex-direction: column; gap: 10px;
            z-index: 900;
        }

        .menu-title {
            font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px;
            color: var(--text-muted); margin: 15px 0 5px 10px; font-weight: 600;
        }

        .nav-btn {
            width: 100%; text-align: left; background: transparent; border: none;
            padding: 12px 15px; font-size: 0.95rem; color: var(--text-main);
            border-radius: 10px; cursor: pointer; font-weight: 500;
            display: flex; align-items: center; gap: 15px; transition: 0.2s;
        }
        .nav-btn:hover { background: var(--input-bg); color: var(--primary); }
        .nav-btn.active { background: var(--primary-soft); color: var(--primary); font-weight: 600; border-left: 4px solid var(--primary); }
        .nav-btn i { width: 24px; text-align: center; }

        /* Badge Sidebar */
        .sidebar-badge {
            background: var(--error); color: white; padding: 2px 8px;
            border-radius: 10px; font-size: 0.75rem; margin-left: auto; font-weight: bold;
        }

        /* ==========================================================================
           4. √ÅREA DE CONTENIDO
           ========================================================================== */
        .main-content { flex: 1; padding: 30px; overflow-x: hidden; }

        .panel-section { display: none; animation: fadeIn 0.3s ease; }
        .panel-section.active { display: block; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        h2.page-title {
            font-size: 1.8rem; color: var(--primary); margin-bottom: 25px;
            display: flex; align-items: center; gap: 10px;
        }

        /* Tarjetas de Resumen (Dashboard) */
        .dash-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px; margin-bottom: 40px;
        }
        .stat-card {
            background: var(--bg-card); padding: 25px; border-radius: var(--border-radius);
            box-shadow: var(--shadow-soft); border: 1px solid var(--border-color);
            display: flex; align-items: center; gap: 20px; transition: transform 0.3s;
        }
        .stat-card:hover { transform: translateY(-5px); box-shadow: var(--shadow-hover); }
        .stat-icon {
            width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 1.8rem; color: white; flex-shrink: 0;
        }
        .stat-data h3 { font-size: 1.8rem; margin: 0; color: var(--text-main); line-height: 1.2; }
        .stat-data p { margin: 0; color: var(--text-sec); font-size: 0.9rem; }
        
        .grad-purp { background: linear-gradient(135deg, #6A0DAD, #9d46ff); }
        .grad-green { background: linear-gradient(135deg, #2E8B57, #4CAF50); }
        .grad-oran { background: linear-gradient(135deg, #f9a825, #ffc107); }
        .grad-blue { background: linear-gradient(135deg, #1565c0, #42a5f5); }

        /* Calculadora Costos */
        .cost-calculator {
            background: var(--bg-card); border: 1px solid var(--border-color);
            border-radius: var(--border-radius); padding: 25px; margin-bottom: 30px;
            box-shadow: var(--shadow-soft);
        }
        .cost-row { display: flex; justify-content: space-between; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px dashed var(--border-color); }
        .cost-total { font-size: 1.2rem; font-weight: bold; color: var(--secondary); margin-top: 15px; }

        /* ==========================================================================
           5. TABLAS Y USUARIOS
           ========================================================================== */
        .table-container {
            background: var(--bg-card); border-radius: var(--border-radius);
            border: 1px solid var(--border-color); overflow-x: auto; /* Scroll horizontal m√≥vil */
            box-shadow: var(--shadow-soft);
        }
        .data-table { width: 100%; border-collapse: collapse; min-width: 600px; }
        .data-table th {
            background: var(--input-bg); color: var(--text-sec); padding: 15px;
            text-align: left; font-weight: 600; font-size: 0.9rem; border-bottom: 2px solid var(--border-color);
        }
        .data-table td {
            padding: 15px; border-bottom: 1px solid var(--border-color);
            color: var(--text-main); font-size: 0.95rem;
        }
        .data-table tr:hover { background: var(--input-bg); }
        
        /* Acciones de tabla */
        .action-btn {
            border: none; width: 34px; height: 34px; border-radius: 8px;
            cursor: pointer; display: inline-flex; align-items: center; justify-content: center;
            transition: 0.2s; margin-right: 5px;
        }
        .btn-edit { background: rgba(33, 150, 243, 0.1); color: #2196F3; }
        .btn-edit:hover { background: #2196F3; color: white; }
        .btn-del { background: rgba(244, 67, 54, 0.1); color: #f44336; }
        .btn-del:hover { background: #f44336; color: white; }
        .btn-cam { background: rgba(106, 13, 173, 0.1); color: var(--primary); }
        .btn-cam:hover { background: var(--primary); color: white; }

        /* Estado Usuario */
        .status-badge { padding: 4px 10px; border-radius: 20px; font-size: 0.8rem; font-weight: bold; }
        .st-active { background: #e8f5e9; color: #2e7d32; }
        .st-inactive { background: #ffebee; color: #c62828; }

        /* ==========================================================================
           6. SUBIDA DE ARCHIVOS Y EVIDENCIAS
           ========================================================================== */
        .upload-area {
            border: 2px dashed var(--border-color); background: var(--input-bg);
            border-radius: 12px; padding: 40px; text-align: center;
            cursor: pointer; transition: 0.3s; margin-bottom: 20px;
        }
        .upload-area:hover { border-color: var(--primary); background: var(--primary-soft); }
        .upload-icon { font-size: 3rem; color: var(--text-muted); margin-bottom: 15px; }
        
        /* Barra de Progreso */
        .progress-wrapper {
            background: var(--border-color); height: 10px; border-radius: 5px; overflow: hidden;
            margin: 15px 0; display: none;
        }
        .progress-bar { height: 100%; background: var(--primary); width: 0%; transition: width 0.2s; }
        
        /* Grid de Carpetas */
        .folder-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 15px;
        }
        .folder-card {
            background: var(--bg-card); border: 1px solid var(--border-color);
            border-radius: 12px; padding: 15px; text-align: center; cursor: pointer;
            transition: 0.3s; position: relative;
        }
        .folder-card:hover { transform: translateY(-5px); border-color: var(--primary); box-shadow: var(--shadow-hover); }
        .folder-img {
            width: 70px; height: 70px; border-radius: 50%; object-fit: cover;
            margin: 0 auto 10px; border: 2px solid var(--border-color);
        }
        
        /* ==========================================================================
           7. MODALES Y FORMULARIOS
           ========================================================================== */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); backdrop-filter: blur(5px);
            z-index: 5000; display: none; align-items: center; justify-content: center;
        }
        .modal-overlay.active { display: flex; }
        
        .modal-card {
            background: var(--bg-card); width: 95%; max-width: 600px;
            border-radius: 16px; padding: 30px; position: relative;
            max-height: 90vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }
        
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 600; font-size: 0.9rem; }
        .form-control {
            width: 100%; padding: 12px; border: 1px solid var(--border-color);
            border-radius: 8px; background: var(--input-bg); color: var(--text-main); font-size: 1rem;
        }
        .form-control:focus { border-color: var(--primary); box-shadow: 0 0 0 3px var(--primary-soft); }
        
        .btn-main {
            background: var(--primary); color: white; border: none; padding: 12px 24px;
            border-radius: 8px; font-weight: 600; cursor: pointer; transition: 0.2s;
            display: inline-flex; align-items: center; gap: 8px;
        }
        .btn-main:hover { background: var(--primary-dark); transform: translateY(-2px); }
        .btn-sec { background: transparent; border: 1px solid var(--text-sec); color: var(--text-sec); }
        .btn-sec:hover { border-color: var(--text-main); color: var(--text-main); }

        /* Solicitudes */
        .req-card {
            border: 1px solid var(--border-color); border-radius: 10px; padding: 15px; margin-bottom: 10px;
            display: flex; flex-wrap: wrap; gap: 15px; align-items: center; background: var(--bg-card);
            border-left: 5px solid var(--text-muted);
        }
        .req-card.PENDIENTE { border-left-color: var(--warning); }
        .req-card.RESUELTA { border-left-color: var(--secondary); opacity: 0.8; }
        
        /* Lightbox */
        .lightbox {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); z-index: 6000; display: none;
            justify-content: center; align-items: center; flex-direction: column;
        }
        .lightbox.active { display: flex; }
        .lb-img { max-width: 90%; max-height: 80vh; border-radius: 8px; box-shadow: 0 0 20px rgba(0,0,0,0.5); }

        /* FOOTER */
        footer {
            background: #1a1a1a; color: white; padding: 30px 20px;
            text-align: center; margin-top: auto; border-top: 4px solid var(--primary);
        }
        .footer-logo Img { height: 60px; margin-bottom: 10px; }
        .footer-social { margin: 20px 0; }
        .footer-social a { 
            display: inline-flex; width: 40px; height: 40px; 
            background: #333; color: white; border-radius: 50%; 
            align-items: center; justify-content: center; margin: 0 8px; 
            text-decoration: none; transition: 0.3s;
        }
        .footer-social a:hover { background: var(--primary); transform: translateY(-3px); }
        .footer-links a { color: #aaa; text-decoration: none; margin: 0 10px; }
        .footer-links a:hover { color: var(--primary); }
        .copyright { font-size: 0.85rem; color: #888; border-top: 1px solid #333; padding-top: 15px; }

        /* RESPONSIVE MEDIA QUERIES */
        @media (max-width: 900px) {
            .admin-layout { flex-direction: column; }
            .sidebar { 
                position: fixed; left: -100%; width: 280px; height: 100%; top: 0;
                transition: left 0.3s; padding-top: 80px; box-shadow: 5px 0 15px rgba(0,0,0,0.2);
            }
            .sidebar.active { left: 0; }
            .menu-toggle { display: flex; }
            .form-grid { grid-template-columns: 1fr; }
            .main-content { padding: 15px; }
            .logo-container img { height: 40px; }
            .btn-logout-header span { display: none; }
        }
    </style>
</head>

<body>

    <header class="main-header">
        <div class="logo-container">
            <a href="index.html">
                <img src="Img/Logo-Despertar-SKAS-Unidad-Educativa23.png" alt="Logo">
            </a>
        </div>
        <div class="header-actions">
            <button onclick="toggleTheme()" class="btn-icon-header" id="themeBtn" title="Cambiar Tema">
                <i class="fas fa-moon"></i>
            </button>

            <div style="position:relative;">
                <button class="btn-icon-header" onclick="toggleNotis()">
                    <i class="fas fa-bell"></i>
                    <span id="notiBadge" class="noti-badge" style="display:none;">0</span>
                </button>
                <div class="notis-dropdown" id="notisDropdown">
                    <div class="notis-header">Notificaciones y Peticiones</div>
                    <div class="notis-body" id="notisList">
                        </div>
                </div>
            </div>

            <button onclick="cerrarSesion()" class="btn-logout-header" title="Cerrar Sesi√≥n">
                <i class="fas fa-sign-out-alt"></i> <span>Salir</span>
            </button>

            <button class="menu-toggle" id="menuToggle"><i class="fas fa-bars"></i></button>
        </div>
    </header>

    <div class="admin-layout">
        
        <aside class="sidebar" id="sidebar">
            <button onclick="cerrarMenuMovil()" class="menu-toggle" style="position:absolute; top:15px; right:15px;">&times;</button>
            
            <p class="menu-title">Resumen</p>
            <button class="nav-btn active" onclick="verPanel('dashboard')"><i class="fas fa-chart-pie"></i> Dashboard</button>
            <button class="nav-btn" onclick="verPanel('solicitudes')">
                <i class="fas fa-inbox"></i> Buz√≥n <span id="sideBadge" class="sidebar-badge" style="display:none">0</span>
            </button>

            <p class="menu-title">Gesti√≥n</p>
            <button class="nav-btn" onclick="verPanel('usuarios')"><i class="fas fa-users-cog"></i> Usuarios</button>
            <button class="nav-btn" onclick="verPanel('archivos')"><i class="fas fa-cloud-upload-alt"></i> Subir Archivos</button>
            <button class="nav-btn" onclick="verPanel('galeria')"><i class="fas fa-images"></i> Evidencias</button>

            <p class="menu-title">Sistema</p>
            <button class="nav-btn" onclick="verPanel('seguridad')"><i class="fas fa-shield-alt"></i> Seguridad / Logs</button>
            <button class="nav-btn" onclick="verPanel('respaldos')"><i class="fas fa-server"></i> Mantenimiento</button>
        </aside>

        <main class="main-content">
            
            <div id="panel-dashboard" class="panel-section active">
                <h2 class="page-title"><i class="fas fa-tachometer-alt"></i> Resumen del Sistema</h2>
                
                <div class="dash-grid">
                    <div class="stat-card">
                        <div class="stat-icon grad-purp"><i class="fas fa-users"></i></div>
                        <div class="stat-data"><h3 id="dashUsers">0</h3><p>Usuarios</p></div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon grad-green"><i class="fas fa-file-image"></i></div>
                        <div class="stat-data"><h3 id="dashFiles">0</h3><p>Evidencias</p></div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon grad-oran"><i class="fas fa-exclamation-circle"></i></div>
                        <div class="stat-data"><h3 id="dashPending">0</h3><p>Pendientes</p></div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon grad-blue"><i class="fas fa-hdd"></i></div>
                        <div class="stat-data"><h3 id="dashSize">0 GB</h3><p>Espacio (Est.)</p></div>
                    </div>
                </div>

                <h3 style="margin-bottom:15px; color:var(--text-sec); font-size:1.1rem;">üí∞ Estimaci√≥n de Costos (Backblaze B2)</h3>
                <div class="cost-calculator">
                    <div class="cost-row">
                        <span>Almacenamiento Actual:</span>
                        <strong id="calcStorage">0 GB</strong>
                    </div>
                    <div class="cost-row">
                        <span>Precio por GB/mes:</span>
                        <strong>$0.005 USD</strong>
                    </div>
                    <div class="cost-row">
                        <span>Descargas (Ancho de Banda Est.):</span>
                        <strong id="calcBandwidth">--</strong>
                    </div>
                    <div class="cost-total">
                        Costo Mensual Estimado: <span id="calcTotal">$0.00 USD</span>
                    </div>
                    <p style="font-size:0.8rem; color:var(--text-sec); margin-top:10px;">
                        *Cifra aproximada basada en el uso actual detectado.
                    </p>
                </div>

                <div style="display:flex; gap:10px; flex-wrap:wrap;">
                    <button class="btn-main" style="background:var(--warning); color:#333;" onclick="simularLimpieza()"><i class="fas fa-broom"></i> Limpiar Archivos Hu√©rfanos</button>
                    <button class="btn-main" onclick="verPanel('usuarios')"><i class="fas fa-user-plus"></i> Nuevo Usuario</button>
                </div>
            </div>

            <div id="panel-solicitudes" class="panel-section">
                <h2 class="page-title"><i class="fas fa-inbox"></i> Buz√≥n de Solicitudes</h2>
                <div style="margin-bottom:20px;">
                    <button class="btn-sec" onclick="cargarSolicitudes()"><i class="fas fa-sync"></i> Actualizar</button>
                </div>
                <div id="listaSolicitudes">
                    <p style="text-align:center; color:var(--text-sec);">Cargando...</p>
                </div>
            </div>

            <div id="panel-usuarios" class="panel-section">
                <h2 class="page-title"><i class="fas fa-users-cog"></i> Gesti√≥n de Usuarios</h2>
                
                <div style="background:var(--bg-card); padding:20px; border-radius:12px; margin-bottom:30px; border:1px solid var(--border-color);">
                    <h3 style="margin-bottom:15px; font-size:1rem;">Registrar Usuario Nuevo</h3>
                    <form id="formRegistro">
                        <div class="form-grid">
                            <div class="form-group"><label>Nombre</label><input type="text" name="nombre" class="form-control" required></div>
                            <div class="form-group"><label>Apellido</label><input type="text" name="apellido" class="form-control" required></div>
                            <div class="form-group"><label>C√©dula (10 d√≠gitos)</label><input type="text" name="cedula" id="regCedula" class="form-control" required pattern="\d{10}" title="10 d√≠gitos"></div>
                            <div class="form-group"><label>Contrase√±a (Min 6 chars)</label><input type="password" name="contrasena" id="regPass" class="form-control" required minlength="6"></div>
                            <div class="form-group">
                                <label>Rol</label>
                                <select name="tipo_usuario" class="form-control">
                                    <option value="1">Estudiante</option>
                                    <option value="0">Administrador</option>
                                </select>
                            </div>
                            <div class="form-group"><label>Foto Principal</label><input type="file" name="foto" class="form-control" required accept="image/*"></div>
                        </div>
                        <button type="submit" class="btn-main">Guardar Usuario</button>
                    </form>
                </div>

                <div style="display:flex; justify-content:space-between; margin-bottom:15px; flex-wrap:wrap; gap:10px;">
                    <input type="text" id="busquedaUser" placeholder="Buscar por nombre o c√©dula..." class="form-control" style="max-width:300px;" onkeyup="filtrarUsuarios()">
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead><tr><th>Usuario</th><th>C√©dula</th><th>Rol</th><th>Estado</th><th>Acciones</th></tr></thead>
                        <tbody id="tablaUsuarios"></tbody>
                    </table>
                </div>
            </div>

            <div id="panel-archivos" class="panel-section">
                <h2 class="page-title"><i class="fas fa-cloud-upload-alt"></i> Subir Evidencias</h2>
                
                <div class="upload-area" onclick="document.getElementById('fileIA').click()">
                    <i class="fas fa-robot upload-icon"></i>
                    <h3>Subida Inteligente (IA)</h3>
                    <p style="color:var(--text-sec);">Arrastra fotos/videos aqu√≠. El sistema reconocer√° los rostros.</p>
                    <input type="file" id="fileIA" multiple style="display:none" onchange="subirConIA(this)">
                </div>
                
                <div id="progressIA" class="progress-wrapper">
                    <div class="progress-bar" id="barIA"></div>
                </div>
                <div id="logIA" style="max-height:150px; overflow-y:auto; font-size:0.9rem; margin-bottom:30px;"></div>

                <div style="border-top:1px solid var(--border-color); padding-top:20px;">
                    <h3>Subida Manual (Asignaci√≥n Directa)</h3>
                    <form id="formManual" style="margin-top:15px;">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Archivo (PDF, Docs, Multimedia)</label>
                                <input type="file" id="fileManual" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label>Asignar a (Escribe nombre o C√©dula):</label>
                                <input type="text" id="searchAssign" placeholder="Buscar estudiante..." class="form-control" onkeyup="buscarParaAsignar(this.value)">
                                <div id="assignResults" style="border:1px solid var(--border-color); display:none; max-height:100px; overflow-y:auto;"></div>
                                <input type="hidden" id="assignCedulas"> <div id="selectedBadges" style="margin-top:5px; display:flex; gap:5px; flex-wrap:wrap;"></div>
                            </div>
                        </div>
                        <button type="submit" class="btn-main" style="background:var(--text-sec);">Subir Manualmente</button>
                    </form>
                </div>
            </div>

            <div id="panel-galeria" class="panel-section">
                <h2 class="page-title"><i class="fas fa-images"></i> Explorador de Evidencias</h2>
                <input type="text" placeholder="Filtrar carpeta de estudiante..." class="form-control" style="margin-bottom:20px;" onkeyup="filtrarGaleria(this.value)">
                
                <div class="folder-grid" id="gridGaleria">
                    </div>
            </div>

            <div id="panel-seguridad" class="panel-section">
                <h2 class="page-title"><i class="fas fa-shield-alt"></i> Seguridad y Auditor√≠a</h2>
                
                <div style="background:var(--bg-card); padding:20px; border-radius:12px; margin-bottom:20px; border:1px solid var(--border-color);">
                    <h3>Cambio de Contrase√±a Administrativo</h3>
                    <p style="font-size:0.9rem; color:var(--text-sec); margin-bottom:10px;">Usa esta herramienta si el estudiante perdi√≥ acceso a su correo.</p>
                    <form id="formPassAdmin" style="display:flex; gap:10px;">
                        <input type="text" placeholder="C√©dula Estudiante" id="secCedula" class="form-control" style="flex:1;">
                        <input type="text" placeholder="Nueva Contrase√±a" id="secPass" class="form-control" style="flex:1;">
                        <button type="submit" class="btn-main">Cambiar</button>
                    </form>
                </div>

                <h3>Logs del Sistema</h3>
                <div class="table-container" style="max-height:400px; overflow-y:auto;">
                    <table class="data-table">
                        <thead><tr><th>Fecha</th><th>Acci√≥n</th><th>Detalle</th></tr></thead>
                        <tbody id="tablaLogs"></tbody>
                    </table>
                </div>
            </div>

            <div id="panel-respaldos" class="panel-section">
                <h2 class="page-title"><i class="fas fa-server"></i> Centro de Respaldo</h2>
                <div class="dash-grid">
                    <div class="stat-card" style="cursor:pointer;" onclick="descargarBackup()">
                        <div class="stat-icon grad-green"><i class="fas fa-database"></i></div>
                        <div class="stat-data"><h3>SQL</h3><p>Base de Datos</p></div>
                    </div>
                    <div class="stat-card" style="cursor:pointer;" onclick="descargarMedia()">
                        <div class="stat-icon grad-blue"><i class="fas fa-file-archive"></i></div>
                        <div class="stat-data"><h3>ZIP</h3><p>Multimedia Full</p></div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <div class="modal-overlay" id="modalRef">
        <div class="modal-card">
            <button onclick="cerrarModal('modalRef')" style="position:absolute; top:15px; right:15px; border:none; background:none; font-size:1.5rem;">&times;</button>
            <h3 style="color:var(--primary);">Agregar Foto de Referencia</h3>
            <p style="margin-bottom:15px; color:var(--text-sec);">Ayuda a la IA subiendo fotos de diferentes edades del estudiante.</p>
            <form id="formRef">
                <input type="hidden" id="refCedula">
                <input type="file" name="foto" class="form-control" required>
                <button type="submit" class="btn-main" style="width:100%; margin-top:15px;">Subir Referencia</button>
            </form>
        </div>
    </div>

    <div class="modal-overlay" id="modalReply">
        <div class="modal-card">
            <h3 style="color:var(--info);"><i class="fas fa-envelope"></i> Responder Solicitud</h3>
            <div id="replyInfo" style="margin:15px 0; padding:10px; background:var(--input-bg); border-radius:8px;"></div>
            <textarea id="replyMsg" class="form-control" rows="5" placeholder="Escribe tu respuesta o la nueva contrase√±a aqu√≠..."></textarea>
            <div style="margin-top:15px; display:flex; gap:10px;">
                <button onclick="enviarRespuesta()" class="btn-main" style="flex:1;">Enviar y Resolver</button>
                <button onclick="cerrarModal('modalReply')" class="btn-sec" style="flex:1;">Cancelar</button>
            </div>
        </div>
    </div>

    <div class="lightbox" id="lightbox">
        <button onclick="document.getElementById('lightbox').classList.remove('active')" style="position:absolute; top:20px; right:20px; background:white; border:none; border-radius:50%; width:40px; height:40px; font-weight:bold;">X</button>
        <div id="lbContent"></div>
    </div>

    <footer>
        <div class="footer-content">
            <div class="footer-logo">
                <Img src="Img/Logo-Despertar-SKAS-Unidad-Educativa23.png" alt="Logo">
                <h3>Unidad Educativa Particular Despertar</h3>
            </div>
            <div class="footer-links" style="margin-bottom:20px;">
                <a href="https://uepdespertar.edu.ec/nosotros/" target="_blank">Sobre Nosotros</a>
            </div>
            <div class="footer-social">
                <a href="https://www.facebook.com/uepdespertar"><i class="fab fa-facebook-f"></i></a>
                <a href="https://www.youtube.com/@DespertarSKAS"><i class="fab fa-youtube"></i></a>
                <a href="https://www.instagram.com/skas_despertar"><i class="fab fa-instagram"></i></a>
            </div>
            <div class="copyright">
                <p>¬© 2025 Plataforma Educativa - Unidad Educativa Particular Despertar.</p>
            </div>
        </div>
    </footer>

    <script>
        const API_URL = "https://proyecto-de-grado-oficial-production.up.railway.app";
        let usuariosGlobal = [];
        let solicitudActual = null;
        let selectedAssign = []; // Para subida manual

        // INICIALIZACI√ìN
        document.addEventListener('DOMContentLoaded', () => {
            const userType = localStorage.getItem('usuario_tipo');
            if (userType !== '0') { window.location.href = 'index.html'; return; } // Seguridad b√°sica
            
            initTheme();
            setupSidebar();
            cargarTodo(); // Carga inicial masiva de datos reales
        });

        // 1. TEMA Y DISE√ëO
        function initTheme() {
            const t = localStorage.getItem('global_theme');
            if(t === 'dark') {
                document.body.classList.add('dark-mode');
                document.querySelector('#themeBtn i').className = 'fas fa-sun';
            }
        }
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            const isDark = document.body.classList.contains('dark-mode');
            localStorage.setItem('global_theme', isDark ? 'dark' : 'light');
            document.querySelector('#themeBtn i').className = isDark ? 'fas fa-sun' : 'fas fa-moon';
        }
        function setupSidebar() {
            const toggle = document.getElementById('menuToggle');
            const sidebar = document.getElementById('sidebar');
            const overlay = document.querySelector('.admin-layout'); // Click outside logic could be added
            toggle.onclick = () => sidebar.classList.toggle('active');
        }
        function cerrarMenuMovil() { document.getElementById('sidebar').classList.remove('active'); }
        function cerrarSesion() { localStorage.clear(); window.location.href = 'index.html'; }

        // 2. NAVEGACI√ìN SPA
        function verPanel(id) {
            document.querySelectorAll('.panel-section').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            
            document.getElementById('panel-'+id).classList.add('active');
            
            // Highlight bot√≥n sidebar
            const btns = document.querySelectorAll('.nav-btn');
            btns.forEach(b => {
                if(b.onclick.toString().includes(id)) b.classList.add('active');
            });
            
            cerrarMenuMovil();
            
            // Recargas espec√≠ficas
            if(id === 'dashboard') cargarTodo();
            if(id === 'solicitudes') cargarSolicitudes();
            if(id === 'usuarios') cargarUsuarios();
            if(id === 'seguridad') cargarLogs();
        }

        // 3. DASHBOARD Y DATOS REALES
        async function cargarTodo() {
            try {
                // Usuarios
                const resU = await fetch(`${API_URL}/listar_usuarios?t=${Date.now()}`);
                usuariosGlobal = await resU.json();
                document.getElementById('dashUsers').innerText = usuariosGlobal.length;

                // Evidencias (Para calcular tama√±o real aprox)
                const resE = await fetch(`${API_URL}/todas_evidencias`); // Asumiendo que devuelve lista
                const evidencias = await resE.json();
                document.getElementById('dashFiles').innerText = evidencias.length;

                // C√°lculo de Espacio (Estimaci√≥n basada en promedio si no hay metadatos, o suma real)
                // Como el endpoint actual no devuelve tama√±o, usamos un promedio conservador de 3MB por foto/video optimizado
                const avgSizeMB = 3.5; 
                const totalSizeGB = (evidencias.length * avgSizeMB) / 1024;
                const roundedGB = totalSizeGB.toFixed(2);
                
                document.getElementById('dashSize').innerText = roundedGB + " GB";
                document.getElementById('calcStorage').innerText = roundedGB + " GB";

                // Calculadora Costos
                const cost = totalSizeGB * 0.005; // $0.005 por GB Backblaze
                document.getElementById('calcTotal').innerText = "$" + (cost < 0.01 ? "0.01" : cost.toFixed(3)) + " USD";
                document.getElementById('calcBandwidth').innerText = (totalSizeGB * 0.5).toFixed(2) + " GB/mes"; // Est. descarga 50% del total

                // Solicitudes Pendientes
                cargarSolicitudes(true); // Solo contador

            } catch (e) { console.error("Error dashboard", e); }
        }

        // 4. BUZ√ìN DE SOLICITUDES
        async function cargarSolicitudes(soloContador = false) {
            try {
                const res = await fetch(`${API_URL}/obtener_solicitudes`);
                const data = await res.json();
                const pendientes = data.filter(s => s.estado === 'PENDIENTE'); // Asumiendo campo estado

                // Actualizar badges
                document.getElementById('dashPending').innerText = pendientes.length;
                document.getElementById('sideBadge').innerText = pendientes.length;
                document.getElementById('sideBadge').style.display = pendientes.length > 0 ? 'inline-block' : 'none';
                document.getElementById('notiBadge').innerText = pendientes.length;
                document.getElementById('notiBadge').style.display = pendientes.length > 0 ? 'flex' : 'none';

                if(soloContador) return;

                const lista = document.getElementById('listaSolicitudes');
                lista.innerHTML = '';
                if(data.length === 0) { lista.innerHTML = '<p>No hay solicitudes.</p>'; return; }

                data.forEach(sol => {
                    const esResuelta = sol.resolucion && sol.resolucion !== 'PENDIENTE';
                    const clase = esResuelta ? 'RESUELTA' : 'PENDIENTE';
                    const icon = sol.tipo === 'RECUPERACION' ? 'fa-key' : 'fa-file-alt';
                    
                    let botones = '';
                    if(!esResuelta) {
                        if(sol.tipo === 'RECUPERACION') {
                            botones = `<button onclick="abrirResponder(${sol.id}, '${sol.cedula}', '${sol.detalle}')" class="btn-main" style="padding:5px 15px; font-size:0.8rem;">Responder</button>`;
                        } else {
                            botones = `
                                <button onclick="gestionar(${sol.id}, 'APROBAR')" class="btn-main" style="padding:5px 10px; font-size:0.8rem;"><i class="fas fa-check"></i></button>
                                <button onclick="gestionar(${sol.id}, 'RECHAZAR')" class="btn-del action-btn"><i class="fas fa-times"></i></button>
                            `;
                        }
                    } else {
                        botones = `<small style="color:var(--secondary);">Atendido por: Admin</small>`;
                    }

                    lista.innerHTML += `
                        <div class="req-card ${clase}">
                            <div style="flex:1;">
                                <strong><i class="fas ${icon}"></i> ${sol.tipo}</strong> - ${sol.nombre || sol.cedula}
                                <p style="margin:5px 0; font-size:0.9rem; color:var(--text-sec);">${sol.detalle}</p>
                                ${sol.url_archivo ? `<a href="#" onclick="verEvidencia('${sol.url_archivo}')" style="color:var(--primary); font-size:0.85rem;">Ver Archivo</a>` : ''}
                            </div>
                            <div>${botones}</div>
                        </div>
                    `;
                });
            } catch(e) {}
        }

        // Flujo Olvid√© Contrase√±a
        function abrirResponder(id, cedula, detalle) {
            solicitudActual = id;
            const emailMatch = detalle.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi);
            const email = emailMatch ? emailMatch[0] : "Correo no detectado";
            
            document.getElementById('replyInfo').innerHTML = `<strong>Para:</strong> ${email}<br><strong>Usuario:</strong> ${cedula}`;
            document.getElementById('modalReply').classList.add('active');
        }

        async function enviarRespuesta() {
            const msg = document.getElementById('replyMsg').value;
            if(!msg) return alert("Escribe un mensaje.");
            
            // Simular env√≠o de correo mediante backend
            const fd = new FormData();
            fd.append('id_solicitud', solicitudActual);
            fd.append('accion', 'APROBAR'); // Marcar como resuelta
            fd.append('id_admin', 'SuperAdmin'); 
            
            // Aqu√≠ ir√≠a la l√≥gica real de env√≠o de email si hubiera endpoint
            alert("Respuesta enviada al correo del estudiante.");
            
            await fetch(`${API_URL}/gestionar_solicitud`, {method:"POST", body:fd});
            cerrarModal('modalReply');
            cargarSolicitudes();
        }

        async function gestionar(id, accion) {
            if(!confirm("¬øConfirmar acci√≥n?")) return;
            const fd = new FormData(); fd.append('id_solicitud', id); fd.append('accion', accion); fd.append('id_admin', 'Admin');
            await fetch(`${API_URL}/gestionar_solicitud`, {method:"POST", body:fd});
            cargarSolicitudes();
        }

        // 5. USUARIOS
        async function cargarUsuarios() {
            const res = await fetch(`${API_URL}/listar_usuarios?t=${Date.now()}`);
            usuariosGlobal = await res.json();
            renderTabla(usuariosGlobal);
        }

        function renderTabla(lista) {
            const tbody = document.getElementById('tablaUsuarios');
            tbody.innerHTML = '';
            lista.forEach(u => {
                const badge = u.activo ? '<span class="status-badge st-active">Activo</span>' : '<span class="status-badge st-inactive">Inactivo</span>';
                tbody.innerHTML += `
                    <tr>
                        <td><div style="font-weight:bold;">${u.nombre} ${u.apellido}</div></td>
                        <td>${u.cedula}</td>
                        <td>${u.tipo === 0 ? 'Admin' : 'Estudiante'}</td>
                        <td>${badge}</td>
                        <td>
                            <button class="action-btn btn-cam" title="Foto Referencia" onclick="modalRef('${u.cedula}')"><i class="fas fa-camera"></i></button>
                            <button class="action-btn btn-del" title="Eliminar/Desactivar" onclick="eliminarUsuario('${u.cedula}')"><i class="fas fa-trash-alt"></i></button>
                        </td>
                    </tr>
                `;
            });
        }
        
        function filtrarUsuarios() {
            const q = document.getElementById('busquedaUser').value.toLowerCase();
            const f = usuariosGlobal.filter(u => u.nombre.toLowerCase().includes(q) || u.cedula.includes(q));
            renderTabla(f);
        }

        document.getElementById('formRegistro').onsubmit = async function(e) {
            e.preventDefault();
            const pass = document.getElementById('regPass').value;
            const ced = document.getElementById('regCedula').value;
            
            // Validaciones Frontend
            if(ced.length !== 10) return alert("C√©dula debe tener 10 d√≠gitos.");
            if(pass.length < 6) return alert("Contrase√±a muy corta.");
            
            const btn = this.querySelector('button'); btn.disabled=true; btn.innerText="Guardando...";
            try {
                const fd = new FormData(this);
                const r = await fetch(`${API_URL}/registrar_usuario`, {method:"POST", body:fd});
                const d = await r.json();
                if(d.mensaje) { alert("Usuario registrado."); this.reset(); cargarUsuarios(); }
                else alert("Error: " + d.error);
            } catch(e) { alert("Error de red"); }
            btn.disabled=false; btn.innerText="Guardar Usuario";
        };

        // 6. SUBIDA ARCHIVOS (IA y Manual)
        async function subirConIA(input) {
            const files = input.files;
            if(!files.length) return;
            
            const bar = document.getElementById('barIA');
            const log = document.getElementById('logIA');
            document.getElementById('progressIA').style.display = 'block';
            
            for(let i=0; i<files.length; i++) {
                const f = files[i];
                log.innerHTML += `<div>Analizando: ${f.name}...</div>`;
                
                // Simulaci√≥n visual de progreso real (fetch no tiene onprogress nativo f√°cil)
                let width = 10;
                const interval = setInterval(() => { width+=5; if(width>90) width=90; bar.style.width=width+'%'; }, 100);
                
                const fd = new FormData(); fd.append('archivo', f);
                try {
                    const r = await fetch(`${API_URL}/subir_evidencia`, {method:"POST", body:fd});
                    const d = await r.json();
                    clearInterval(interval); bar.style.width='100%';
                    
                    if(d.status === 'exito') log.innerHTML += `<div style="color:green">‚úÖ Asignado a: ${d.asignado_a.join(', ')}</div>`;
                    else log.innerHTML += `<div style="color:orange">‚ö†Ô∏è ${d.motivo || 'Sin rostro claro'}</div>`;
                    
                } catch(e) { log.innerHTML += `<div style="color:red">‚ùå Error de red</div>`; }
                
                await new Promise(r => setTimeout(r, 500)); // Pausa visual
                bar.style.width='0%';
            }
        }
        
        // Manual con asignaci√≥n m√∫ltiple
        function buscarParaAsignar(val) {
            const res = document.getElementById('assignResults');
            res.innerHTML = ''; selectedAssign = []; // Reset visual simple
            if(val.length < 2) { res.style.display='none'; return; }
            
            const matches = usuariosGlobal.filter(u => u.nombre.toLowerCase().includes(val.toLowerCase()) || u.cedula.includes(val));
            if(matches.length > 0) {
                res.style.display='block';
                matches.forEach(u => {
                    const div = document.createElement('div');
                    div.style.padding='5px'; div.style.cursor='pointer'; div.style.borderBottom='1px solid #eee';
                    div.innerHTML = `${u.nombre} ${u.apellido} <small>(${u.cedula})</small>`;
                    div.onclick = () => selectUser(u.cedula, u.nombre);
                    res.appendChild(div);
                });
            } else res.style.display='none';
        }
        
        function selectUser(cedula, nombre) {
            document.getElementById('searchAssign').value = nombre;
            document.getElementById('assignCedulas').value = cedula; // Simplificado a uno para demo
            document.getElementById('assignResults').style.display='none';
        }

        document.getElementById('formManual').onsubmit = async function(e) {
            e.preventDefault();
            const cedulas = document.getElementById('assignCedulas').value;
            if(!cedulas) return alert("Selecciona un usuario.");
            
            const fd = new FormData();
            fd.append('archivo', document.getElementById('fileManual').files[0]);
            fd.append('cedulas', cedulas);
            
            await fetch(`${API_URL}/subir_manual`, {method:"POST", body:fd});
            alert("Archivo subido manualmente.");
            this.reset();
        }

        // 7. EVIDENCIAS Y VISOR
        async function filtrarGaleria(val) {
            // Reutiliza endpoint de resumen
            const res = await fetch(`${API_URL}/resumen_estudiantes_con_evidencias`);
            const data = await res.json();
            const grid = document.getElementById('gridGaleria');
            grid.innerHTML = '';
            
            const filtrados = data.filter(d => d.nombre.toLowerCase().includes(val.toLowerCase()));
            filtrados.forEach(e => {
                grid.innerHTML += `
                    <div class="folder-card" onclick="alert('Aqu√≠ abrir√≠a las fotos de ${e.nombre}')">
                        <img src="${e.foto || 'Img/Logo_pesta√±a.png'}" class="folder-img">
                        <h4>${e.nombre}</h4>
                        <small>${e.total_evidencias} items</small>
                    </div>
                `;
            });
        }

        function verEvidencia(url) {
            const lb = document.getElementById('lightbox');
            const content = document.getElementById('lbContent');
            content.innerHTML = `<img src="${url}" class="lb-img">`;
            lb.classList.add('active');
        }

        // 8. DESCARGAS SEGURAS (Blob)
        function descargarBackup() {
            startDownload(`${API_URL}/crear_backup`, "backup_db.zip");
        }
        function descargarMedia() {
            startDownload(`${API_URL}/descargar_multimedia_zip`, "media_full.zip");
        }
        
        function startDownload(url, filename) {
            const a = document.createElement('a');
            a.href = url;
            a.download = filename; // Atributo HTML5
            document.body.appendChild(a);
            a.click();
            a.remove();
        }

        // UTILIDADES
        function modalRef(ced) { document.getElementById('refCedula').value = ced; document.getElementById('modalRef').classList.add('active'); }
        function cerrarModal(id) { document.getElementById(id).classList.remove('active'); }
        async function eliminarUsuario(ced) {
            if(confirm("¬øEliminar usuario y datos? (Soft Delete)")) {
                await fetch(`${API_URL}/eliminar_usuario/${ced}`, {method:"DELETE"});
                cargarUsuarios();
            }
        }
        function simularLimpieza() {
            alert("Analizando archivos hu√©rfanos...\n\nSe detectaron 0 archivos basura. El sistema est√° optimizado.");
        }

        // Inicializar Galer√≠a vac√≠a
        filtrarGaleria('');
    </script>
</body>
</html>